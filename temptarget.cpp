#include "temptarget.h"

#define MAX_TenMinCount 143
#define MAX_TenSecCycleCount 60


struct temp{
    float Mean;
    float sd;
};

temp tempArray[] = {
    {36.23,1.93},	{37.6,1.74},	{38.92,1.77},
	{40.26,2.14},	{41.23,2.48},	{42.43,2.63},	{43.96,2.57},
	{45.26,2.57},	{46.27,2.87},	{47.52,2.89},	{48.28,3.31},
	{49.3,3.01},	{50.52,2.82},	{51.21,3.41},	{52.36,2.76},
	{53.09,3.32},	{54.35,3.37},	{55.24,3.12},	{55.82,3.57},
	{56.74,3.45},	{57.16,3.76},	{58.1,3.5},	{58.71,3.34},
	{59.22,3.35},	{59.77,3.61},	{60.13,3.74},	{60.4,3.61},
	{60.8,3.52},	{60.81,3.55},	{60.94,3.6},	{60.86,3.89},
	{60.48,4.47},	{60.86,3.69},	{60.23,4.22},	{60.49,3.74},
	{60.26,3.7},	{59.41,4.77},	{58.89,4.98},	{58.7,5.06},
	{58.02,4.6},	{57.69,4.15},	{57.1,3.92},	{56.66,3.74},
	{56.3,2.62},	{55.33,3.12},	{54.6,2.32},	{53.89,2.27},
	{52.86,2.42},	{51.92,2.18},	{50.94,2.11},	{49.96,2.09},
	{48.8,2.2},	{47.73,2.06},	{46.54,2.06},	{45.33,2.07},
	{44.1,2.08},	{42.84,2.06},	{41.56,2.06},	{40.3,2.05},
	{39.08,1.96},	{37.84,1.77},	{36.75,1.66},	{35.77,1.58},
	{34.93,1.54},	{34.18,1.48},	{33.5,1.43},	{32.89,1.36},
	{32.36,1.3},	{31.89,1.25},	{31.43,1.23},	{31.01,1.2},
	{30.62,1.18},	{30.27,1.14},	{29.94,1.11},	{29.64,1.09},
	{29.36,1.09},	{29.09,1.08},	{28.82,1.05},	{28.55,1.03},
	{28.31,1.01},	{28.09,1.01},	{27.89,1},	{27.68,1},
	{27.49,0.99},	{27.31,1},	{27.1,1},	{26.89,1},	{26.69,1.03},
	{26.51,1.04},	{26.32,1.05},	{26.15,1.08},	{25.97,1.09},
	{25.8,1.11},	{25.63,1.11},	{25.49,1.17},	{25.33,1.2},
	{25.2,1.23},	{25.09,1.25},	{24.99,1.24},	{24.87,1.26},
	{24.75,1.27},	{24.65,1.31},	{24.59,1.35},	{24.51,1.41},
	{24.43,1.47},	{24.37,1.51},	{24.29,1.52},	{24.2,1.55},
	{24.12,1.59},	{24.06,1.56},	{24.01,1.51},	{23.95,1.52},
	{23.88,1.53},	{23.85,1.56},	{23.84,1.57},	{23.77,1.6},
	{23.74,1.65},	{23.76,1.72},	{23.72,1.79},	{23.63,1.83},
	{23.53,1.8},	{23.45,1.78},	{23.35,1.74},	{23.3,1.75},
	{23.26,1.8},	{23.26,1.86},	{23.26,1.89},	{23.24,1.9},
	{23.23,1.86},	{23.29,1.84},	{23.42,1.78},	{23.66,1.7},
	{23.98,1.64},	{24.44,1.59},	{24.93,1.5},	{25.74,1.28},
	{26.63,1.13},	{27.56,1.16},	{28.7,1.17},	{29.74,1.29},
	{30.96,1.36},	{32.11,1.46},	{33.45,1.66},	{34.89,1.77}
};

TempTarget::TempTarget()
{
    //ctor
}

TempTarget::~TempTarget()
{
    //dtor
}

float TempTarget::controlTemp(int TenMinCount, int TenSecCycleCount){
    int nextTenMinCount;
    if(TenMinCount = MAX_TenMinCount) nextTenMinCount = 0;
    else nextTenMinCount = ++TenMinCount;
    float temp = tempArray[TenMinCount].Mean;
    float nextTemp = tempArray[nextTenMinCount].Mean;
    float delta = nextTemp - temp;
    return temp + delta*(TenSecCycleCount/MAX_TenSecCycleCount);
}

float TempTarget::testTemp(int TenMinCount, int TenSecCycleCount){
    int nextTenMinCount;
    if(TenMinCount = MAX_TenMinCount) nextTenMinCount = 0;
    else nextTenMinCount = ++TenMinCount;
    float temp = tempArray[TenMinCount].Mean + 2*tempArray[TenMinCount].sd;
    float nextTemp = tempArray[nextTenMinCount].Mean + 2*tempArray[nextTenMinCount].sd;
    float delta = nextTemp - temp;
    return temp + delta*(TenSecCycleCount/MAX_TenSecCycleCount);
}
